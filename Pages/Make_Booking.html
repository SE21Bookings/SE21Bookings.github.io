<!doctype html>
<html>
	<head>
		<title>SE21 Make Bookings</title>
		<link rel="stylesheet" href="../CSS/MAIN.css">
		<link rel="stylesheet" href="../CSS/bootstrap.css">
		<script src="../JS/jquery.js" type="text/javascript" charset="utf-8"></script>
		<script src="../JS/MAIN.js" type="text/javascript" charset="utf-8"></script>
		<script src="../JS/GenerateTable.js" type="text/javascript" charset="utf-8"></script>
		<script src="../JS/aws-cognito.js"></script>
		<script src="../JS/NicEdit.js" type="text/javascript"></script>
		<script type="text/javascript">bkLib.onDomLoaded(nicEditors.allTextAreas);</script>
		<script type="text/javascript" src="https://cdn.emailjs.com/dist/email.min.js"></script>
		<script type="text/javascript">
		   (function(){
			  emailjs.init("user_dNUTnHrGIx2yGv4lkBnqw");
		   })();
		</script>
	</head>
	
	<body id="bookingsBody">
		<div id="navBar"></div>
		<p id="welcomeMsg">Welcome:</p>
		<div id="imgnHeaderDiv">
			<center><em><h1 style="font-weight:300;">[Click on a room to book it]</h1></em></center>
			<img src="../Img/se21 layout.png" id="frontPageMap" border="3px">
		</div>
		
		<div id="mapBtnsDiv">
			<div onClick="openModal(); loadinTech1Week1(); " id="Tech1Btn"></div>
			<div onClick="openModal();" id="Tech2Btn"></div>
			<div onClick="openModal();" id="Tech3Btn"></div>
			<div onClick="openModal();" id="Tech4Btn"></div>
			<div onClick="openModal();" id="Tech5Btn"></div>
			<div onClick="openModal();" id="VRBtn"></div>
		</div>
		
		<div id="errorModule">
			<div id="ErrorBox" class="ErrorColor">
				<p>Error: timetable connection broken</p>
				<button onClick="location.reload();">Reload</button>
			</div>
		</div>
		
		<div id="timeTableModal" class="modal">
		  <div class="timeTableModal-content">
			<span class="close">&times;</span>	
				<h3 id="timeTableTitle">Timetable:</h3>
				<button id="whichWeekBtn"></button>
				<div id="viewPort">
					<div id="viewPort_Content">
						<div id="DivDescription">
							<label id="Description"></label>
						</div>
						<label id="bookingDetails">.......</label>
						<br class="noHeightBreak">
						<label id="bookingStatus">.......</label><br>
						<br>					
						<button id="bookBtn">Quick Book</button>
						<button id="rbookBtn">Book Recurring</button>				
						<button id="quickLockBtn">Lock</button>
						<button id="lessonLockBtn">Lesson</button>
						<button id="deleteBtn">Delete</button>
						<button id="contactBtn">Contact</button>
					</div>	
					<div id="preLimLoader">
						<em><p id="preLimLoaderText">[Click on a Timeslot to View Bookings]</p></em>
					</div>
				</div>
				
				<div id="timeTable"></div>
				
				<div id="Loader">
					<img width="30%" src="../Img/copper-loader.gif">
				</div>
		  </div>
		</div>
		
		<div id="emailModal" class="HigherModal">
			<div class="emailModal-content">
				<span class="close1">&times;</span>
				<input disabled type="email" id="toEmail"><br>
				<input placeHolder="Subject" type="text" id="subject">
				<textarea id="emailText"></textarea>
				<button id="sendBtn">Send</button>
				<p id="emailErrMsg"></p>
			</div>
		</div>
		<div id="BookRecuring" class="HigherModal">
			<div class="BookRecuring-content">
				<span class="close2">&times;</span>
				<input placeholder="ECA:" type="text" id="eca"><br>
				<input placeholder="Description" type="text" id="ecaDes"><br>
				<select id="AlternatingWeeks">
					<option value="lock1">Week 1s Only</option>
					<option value="lock2">Week 2s Only</option>
					<option value="lock1lock2">Week 1 & Week 2</option>
				</select>
				<br>
				<select id="Recurrence" onChange="checkRecurrence()">
					<option value="PR">Perpetual Recurrence</option>
					<option value="NPR">Non-Perpetual Recurrence</option>
				</select>
				<br>
				<input type="number" placeholder="How many Weeks" id="howManyWeeks"><br>
				<button id="BookRecrBtn">Book</button>
			</div>
		</div>
		
	</body>
	
	<script>//Initlizers
		$("#navBar").load("../DynamicLoad_Modules/NavBar.html")
		getEmail()
		checkVariable()
		function checkVariable()  // welcomeMsg Loader
		{
			if (email != null) 
			{
			   if(localStorage.getItem("adminPriv") == "false")
			   {
				   $("#welcomeMsg").html("Welcome: " + email)
			   }
			   else if(localStorage.getItem("adminPriv") == "true")
			   {
				   $("#welcomeMsg").html("Welcome_Admin: " + email)
			   }
			   else
			   {
				   self.location = "../index.html"
			   }
		   	}
			else
			{
				setTimeout(checkVariable, 1000);
			}
		}

		 
		$("#welcomeMsg")
	</script>
	<script> //Timetable Modal Code
		var modal = document.getElementById('timeTableModal');
		// Get the <span> element that closes the modal
		var span = document.getElementsByClassName("close")[0];

		// When the user clicks on the button, open the modal 
		function openModal() {
			modal.style.display = "block";
		}
		// When the user clicks on <span> (x), close the modal
		span.onclick = function() {
			modal.style.display = "none";
		}
	</script>
	<script>//email Modal Code
		var emailmodal = document.getElementById('emailModal');
		var openEmailbtn = document.getElementById("contactBtn");
		var span1 = document.getElementsByClassName("close1")[0];
		
		openEmailbtn.onclick = function() {
			//modal.style.display = "none";
			emailmodal.style.display = "block";
			
		}
		
		// When the user clicks on <span> (x), close the modal
		span1.onclick = function() {
			emailmodal.style.display = "none";
		}	
	</script>	
	<script>//Recurring Booking Modal
		var Rbook = document.getElementById('BookRecuring');
		var openrBookbtn = document.getElementById("rbookBtn");
		var span2 = document.getElementsByClassName("close2")[0];
		
		openrBookbtn.onclick = function() {
			//modal.style.display = "none";
			Rbook.style.display = "block";
			$("#howManyWeeks").hide();
			
		}
		
		// When the user clicks on <span> (x), close the modal
		span2.onclick = function() {
			Rbook.style.display = "none";
		}
	</script>
	
</html>
